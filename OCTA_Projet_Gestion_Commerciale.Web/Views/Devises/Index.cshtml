@using Infragistics.Web.Mvc
@model IQueryable<OCTA_Projet_Gestion_Commerciale.Model.GEN_Devises>

@{
    ViewBag.Title = "Liste des devises";
    //Layout = "";
}

@(Html.Infragistics()
    .Loader()
            .ScriptPath(Url.Content("~/Scripts/Infragistics/js/"))
            .CssPath(Url.Content("~/Content/Infragistics/css"))
            .AutoDetectLocale(true)
            .Resources("igGrid.*,igCombo")
    .Render())

@*@section buttons {
    @*<h3 class="panel-title"><strong>@ViewBag.Title</strong></h3>
    <div class="col-md-18">

    </div>

    <ul class="panel-controls">
        <li><button class="btn btn-primary btn-block" type="button" onclick="window.location.href='@Url.Action("Create")'">Nouvelle devise</button></li>
    </ul>
}*@


<div class="grilleIgnite">
    @(Html.Infragistics()
     .Grid<OCTA_Projet_Gestion_Commerciale.Model.GEN_Devises>(Model)
     .ID("listGridDevises")
     .AutoGenerateColumns(false)
     .AutoGenerateLayouts(false)
     .RenderCheckboxes(true)
     .AutoCommit(true)
     .Columns(column =>
     {
         column.For(x => x.DevisesId).Hidden(true);
         column.For(x => x.DevisesCode).Width("20%").Template("<a href='" + @Url.Action("Create", "Devises") + "/${DevisesId}\' \">${DevisesCode}</a>");/*.FormatterFunction("lookupDevise")*/;
         column.For(x => x.DevisesCodeIso).Width("20%");
         column.For(x => x.DevisesDescription).Width("20%");
         //column.For(x => x.TenueDeCompte).Width("20%").FormatterFunction("lookupTenueDeCompte");
         column.For(x => x.DevisesActif).Width("20%").FormatterFunction("lookupActif");

     })
     .Features(feature =>
     {
         feature.Updating().EnableAddRow(false).EnableDeleteRow(false).EditMode(GridEditMode.None);

         feature.Filtering().Mode(FilterMode.Simple).Type(OpType.Local);
         feature.Sorting();
         feature.Resizing();
         feature.ColumnMoving();
         feature.Paging().PageSize(10);

     })
     .PrimaryKey("Id")
     .DataBind()
     .Width("100%")
     .Render()
    )

    <script type="text/javascript">
            var  gridDevises=$('#listGridDevises'),
                 listTenueDeCompte=@Html.Raw(Json.Encode(ViewBag.ListTenueDecompte));


            function lookupActif(id, record) {

                if (record.Actif) {

                    return '<div class="checkboxStyle"><input type="checkbox" value="1" id="checkboxInput_' + record.Id + '" name="" checked/><label ></label></div>';

                }
                else {
                    return '<div class="checkboxStyle"><input type="checkbox" value="0" id="checkboxInput_' + record.Id + '" name="" /><label ></label></div>';

                }
                return '';
            }


            function lookupTenueDeCompte(id,record) {
                if(record.TenueDeCompte==1){
                    return '<div class="checkboxStyle"><input type="checkbox" value="1" id="checkboxInput_' + record.Id + '" name="" checked /><label ></label></div>';

                    //return '<span class="btn-sm btn-success statutRB">Oui</span>';
                }
                else if(record.TenueDeCompte==0){
                    //return '<span class="btn-sm btn-danger statutRB">Non</span>';
                    return '<div class="checkboxStyle"><input type="checkbox" value="0" id="checkboxInput_' + record.Id + '" name="" /><label ></label></div>';

                }

                return '';
            }


            gridDevises.on("iggridrendered", function (e, ui) {
                //replaceComboFilterEditor('listGridDevises', 'Code', listDevises);
                replaceComboFilterEditor('listGridDevises', 'TenueDeCompte', listTenueDeCompte);
            });

            $(document).ready(function () {
                var messageErreur = "@(new MvcHtmlString((string)ViewBag.Message))";
                if (messageErreur != "") {
                    alert(messageErreur);

                }
            });



    </script>
</div>





